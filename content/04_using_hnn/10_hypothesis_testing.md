<!--
# Title: 4.10 Hypothesis Testing
# Updated: 2025-02-04
#
# Contributors:
# Dylan Daniels
-->

# Process for Defining and Testing Hypotheses and Parameter Estimation

Working with large-scale neural models is challenging because not all parameters can be estimated at once. While one might want to simply feed in a waveform and have the model spit out all the possible parameter combinations that can create this waveform, at this time, that is not possible in HNN or in any large-scale neural modeling framework. There are simply too many parameters and possible parameter combinations. In practice, pieces of the model (e.g. individual cells and synaptic connections) are developed and parameters are tuned and fixed based on best-known biophysical constraints (e.g. morphology and physiology). Once an acceptable representation of elements of the model is developed, most parameters are fixed and parameter tuning and estimation are performed on a limited targeted set of parameters to test hypotheses on if and how those parameters contribute to specific signals of interest and changes in the signal across experimental conditions/subjects.

HNN provides a pre-tuned neocortical column model and tutorials on how to begin to activate the model with exogenous thalamocortical and cortical-cortical drive as described above. In practice, users start with hypotheses about how the network is activated during the experimental conditions they are studying (e.g. sequence of feedforward and feedback drive), and test if and how the parameters representing this activation (e.g. strength of distal input to layer ⅔ pyramidal vs inhibitory cells) can be adjusted to get an accurate representation of the source data. If they can, then the “tuned” model provides multi-scale testable predictions on the underlying cell and network activity creating the signal. If they can’t, alternative hypotheses can be tested. It may be that more than one set of parameter combinations (i.e. “models”) can provide a “good fit” to the data (defined below). As discussed above, currently in large-scale biophysically detailed models, we can not test all possible parameter combinations. In practice, most parameters are fixed based on best-known constraints and only a small number of parameters are estimated based on “testing hypotheses”. When using HNN, users often define a handful of logical hypotheses and identify the parameters that correspond to testing these hypotheses. Hypothesis testing in this context means that through parameter estimation (described further below) users determine if and how any of the targeted parameters is able to provide a better fit to the data.  If more than one set of parameters generates a good fit to the data, by definition the underlying multiscale cell and circuit level activity will be different because they are defined by different parameters (i.e. “models”). These microcircuit differences provide targets for further model selection based on data from invasive animal recordings and/or other imaging methods, discussed further below.

Below, we give a concrete example of how hypotheses can be developed and tested in HNN, and compared to alternative hypotheses. First, we describe the parameter estimation process where the “goodness of fit” of the model is assessed by examining the root mean squared error (RMSE) between the simulated and empirical current source signals. An acceptable fit depends on the user-defined criteria on a good fit threshold. HNN does not currently provide tools for accessing the quality of the fit between model and source data beyond RMSE, nor does it provide a method for statistically comparing alternate models. Rather, the user can test multiple predictions and report the one that gives the closest fit (smallest RMSE) to the data. HNN also does not currently have methods to fit model parameters to other types of empirical data e.g. cell spike rate and/or LFP/CSD. Such method developments are ongoing and represent important future directions.

### Parameter Estimation Process

Once a hypothesized pattern of drive to the local circuit representing the conditions of the experiment is determined, the process for adjusting parameters in HNN is as follows. Users first adjust parameters via exploration and “hand tuning”  to get a sense of how parameter changes map onto multi-scale changes in the model. This sense comes from visually examining the multi-scale output in the HNN GUI, including directly comparing the source signals from the model and data. We can not emphasize enough the importance of hand tuning and exploration to understand how the model components contribute to the signal.

Once an initial close representation of the signal is found via hand tuning (i.e. small RMSE error between model and data current dipole waveforms), users can define a targeted set of parameters for algorithmic estimation of values that produce the “best fit to data” (determining the goodness of fit is defined above). Currently, HNN only has built-in parameter estimation tools for parameters of the exogenous drive during an evoked response simulation that employ a temporally-weighted loss function optimized using gradient-free solvers (see Optimization Tutorial). Additional parameter estimation methods are in the development phase.

Once a good first-to-one signal is determined, users may wish to next test hypotheses on the cell and circuit mechanisms underlying differences in signals across experimental conditions (e.g., see testing of hypotheses on differences in sensory-driven responses in typically developing children vs children with autism spectrum disorder25; or differences in auditory evoked responses across hemispheres15).

The final set of parameters that produce an accurate representation of the data provides predictions on the circuit activity at multiple scales (cell-specific spiking patterns, LFP/CSD.. etc). These predictions all provide targets for testing further in the real brain (see Fig 3 and section below).

### Parameter Sensitivity

 Once a “good fit” to data is found (defined above), the sensitivity of the fit to variation in model parameters can be made. HNN is not yet distributing tools for parameter sensitivity analysis. For an example of how to use the python package 'Uncertainty'36 to apply sensitivity analysis on parameters see the supplementary materials in the HNN methods paper (Neymotin et al eLife 2020). This example uses the method of variance-based sensitivity analysis through Monte Carlo estimation37 and provides Sobol sensitivity indices that can be used to explain the relative contribution of individual parameters on model variance. The total Sobol sensitivity index for each parameter serves as a measure that represents that parameter’s contribution to the variance, and also the contributions resulting from interactions with other parameters being varied38. So a parameter with a low total Sobol sensitivity index can be characterized as an insignificant contributor to variance and can be fixed at its default value during model optimization.

### Example of how HNN can be used to develop and test hypotheses (see also alpha/beta tutorial)

A primary example of HNN’s utility in developing and testing hypotheses comes from our work studying the neural origin of the transient 15-29Hhz beta oscillations (e.g. beta events) observed in source-localized MEG signals from SI. Here, beta emerges as part of a rhythm that contains non-overlapping transient alpha and beta components and is known as the somatosensory “mu” rhythm8,19). We began with knowledge from prior studies of the circuit mechanisms underlying alpha and beta generation. A long history of research has shown that alpha rhythms can emerge from ~10Hz bursting in the thalamus that activates the cortex through layer-specific thalamocortical projections (see Hughes and Crunelli 200535 for review). Prior theories on beta generation, based mostly on slice experiments and modeling, suggested beta originates from fast synaptic interactions between excitatory and inhibitory neurons that act in concert with slow potassium currents (AHP currents) in excitatory neurons to pace the excitatory cells to fire regularly at a beta frequency17,32–34. HNNs Template Model contains the circuit elements needed to test if these mechanisms could account for alpha and beta events in our human MEG data.  We began with parameter exploration and simulated 10Hz bursts of activity that activated the model via the thalamocortical projection pattern (i.e. proximal drive Fig. 1) and drove spiking in the cortical excitatory cells, which we predicted could in turn create the beta component of the rhythm through the local excitatory and inhibitory connections. Despite extensive parameter tuning efforts, we found that while alpha could be generated this way, we could not accurately simulate beta.  Instead, by parameter exploration we found a completely novel mechanism that closely produced numerous quantified data features (Fig. 3 A/B8);  this analysis was only possible because of the detail in the HNN template model that enabled a one-to-one comparison between model output and data in the same physical nAm units.  This mechanism suggested that there were two distinct generators of 10Hz bursting activity, one that drove the network through the proximal projection pathway and one through the distal projection pathways (possibly representing activity in lemniscal and non-lemniscal thalamic nuclei ). When the bursts arrived asynchronous to the cortex alpha events emerged and when they arrived nearly synchronously beta events emerged8 (see also alpha/beta tutorial). Of note, while we examined variation in parameters, we did not perform automated parameter fitting or parameter sensitivity analyses in this study. This mechanism for alpha generation was consistent with prior studies (Bollimunta et al 2008) but represented a completely new theory on the generation of beta. Owing to HNN’s biophysical detail, additional testable predictions on the expected layer-specific LFP and CSD could be made. These predictions were detailed in19 and supported by laminar recordings in mice and monkeys (Fig. 3C), and later with high-resolution laminar MEG that also suggested a similar beta event mechanism occurs in the primary motor cortex26. Further model analysis with HNN-predicted beta events generated via these mechanisms may causally suppress tactile perception through the recruitment of supragranular inhibition20; this prediction is currently being tested with invasive animal recordings.

<div class="stylefig">
  ![](https://raw.githubusercontent.com/jonescompneurolab/hnn-under_the_hood/master/html-styling/images/beta-events.png)
  <!-- <p style="text-align:justify;"> -->
  <p>
    Figure 3 (A) Hypothesized mechanisms of beta event generation in the HNN model accurately reproduced quantified features of (B) MEG-measured beta events. (C) Multi-scale model predictions on the LFP and CSD underlying the macro-scale beta events were validated with laminar recordings in mice and monkeys19.
  </p>
</div>


# Validating that the multi-scale model-derived predictions are true in the brain

Due to the level of detail in HNNs Template Model, once a “good fit” to the macro-scale current source data is found, multi-scale predictions on the underlying micro- and mesoscale activity are available. There are numerous techniques for validating these multi-scale model-derived predictions, including invasive recordings (e.g. Neuropixels, calcium imaging) in animals, and/or other human imaging modalities (e.g. MRI-spectroscopy, laminar resolution MEG26) to name a few. See Fig. 3 and the description above as one example.

We are developing tools that can further facilitate this validation process, including expanded parameter estimation techniques that can constrain model output to multiple data types (e.g. spike rates, LFP/CSD). A key technique for validating model hypotheses is recording across the cortical layers (e.g. laminar recordings) as the source of human M/EEG signals necessarily relies on the integration of information across the layers.

In practice, the development and validation of model-derived predictions will take collaborative efforts between researchers with different expertise including human imaging researchers and clinicians, neural modeling experts, and neurophysiologist recording invasively in animal models. A goal of our HNN workshops and open-source modeling framework is to bring together researchers with varied backgrounds and expertise who are all interested in bridging the gap between human and animal research.
